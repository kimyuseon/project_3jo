{% extends "base.html" %}
{% load static %}

{% block content %}
<style>
    /* 부모 컨테이너가 잡고 있는 여백을 무시하고 화면 끝까지 넓히기 */
    #full-width-wrapper {
        width: 100vw;       
        position: relative;
        left: 50%;
        right: 50%;
        margin-left: -50vw;
        margin-right: -50vw;
        background: #f8f9fa; 
        padding: 40px 0;    
    }

    .post-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr); 
        gap: 25px;         
        width: 96%;        
        margin: 0 auto;
    }

    .post-card {
        background: white;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        cursor: pointer;
        transition: transform 0.2s;
    }

    .post-card:hover {
        transform: translateY(-5px);
    }

    .post-image-wrapper {
        width: 100%; 
        aspect-ratio: 16 / 10; 
        background: #eee;
    }

    .post-content-area {
        padding: 25px;
    }
</style>

<div id="full-width-wrapper">
    <div id="post-list-container">
        <div style="width: 96%; margin: 0 auto 30px; display: flex; justify-content: space-between; align-items: center;">
            <h2 style="font-size: 32px; font-weight: 800; color: #333;">커뮤니티 게시판</h2>
 
            {% if user.is_authenticated %}
                <a href="{% url 'community:post_add' %}" 
                   style="background: #ff6b6b; color: white; text-decoration: none; padding: 12px 25px; border-radius: 35px; font-weight: bold; font-size: 16px;">
                   새 글 작성하기
                </a>
            {% endif %}
        </div>

        <div class="post-grid">
            {% for post in posts %}
                <div class="post-card" onclick="location.href='{% url 'community:post_detail' post.id %}'">
                    <div class="post-image-wrapper">
                        {% if post.thumbnail %}
                            <img src="{{ post.thumbnail.url }}" style="width: 100%; height: 100%; object-fit: cover;">
                        {% else %}
                            <div style="height: 100%; display: flex; align-items: center; justify-content: center; color: #ccc;">No Image</div>
                        {% endif %}
                    </div>
                    
                    <div class="post-content-area">
                        <h3 style="font-size: 22px; margin-bottom: 12px; font-weight: 700; color: #222;">{{ post.title }}</h3>
                        <p style="color: #666; font-size: 15px; line-height: 1.6; height: 48px; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;">
                            {{ post.content }}
                        </p>
                        
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #f1f1f1; display: flex; justify-content: space-between; font-size: 13px; color: #999;">
                            <span>{{ post.author.username|default:"익명" }}</span>
                            <span style="color: #ff6b6b; font-weight: bold;">{{ post.comment_set.count }}</span>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}